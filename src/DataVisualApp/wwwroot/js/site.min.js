!function(){null!=document.getElementById("app")&&(document.getElementById("app").style.display="")}(),function(){"use strict";angular.module("SurveyApp",["ngAnimate","angular-jqcloud"])}(),function(){"use strict";function e(e){if(angular.isDate(e)){var t=e.getDate(),o=e.getMonth()+1,n=e.getFullYear();return n+"-"+o+"-"+t}return null}function t(t,o){function n(e){function t(e){var t=/(\bcomments\b)|(\bfrom\b)|(\bhave\b)|(\bmuch\b)|(\bname\b)|(\bonly\b)|(\bstill\b)|(\bthat\b)|(\bthey\b)|(\bthis\b)|(\bvery\b)|(\bwent\b)|(\bwere\b)|(\bwhich\b)|(\bwith\b)|(\bwould\b)|(\byour\b)|(\b(\w{1,3})\b)|(\b[0-9]+\b)|(\bbeing\b)|(\bshould\b)|(\babout\b)|(\bcould\b)|(\bbeen\b)|(\bthere\b)|(\bwoman\b)|(\bmother\b)|(\bwell\b)|(\bwhen\b)|(\btheir\b)|(\bfeel\b)|(\btold\b)|(\bdont\b)|(\bresponse\b)|(\bsomeone\b)|(\btook\b)|(\bwill\b)|(\baway\b)|(\bwhat\b)|(\bleft\b)|(\bnothing\b)|(\bcomment\b)|(\bdone\b)|(\beven\b)|(\bmade\b)|(\bthen\b)|(\bnone\b)|(\bsome\b)|(\bbefore\b)|(\bfelt\b)|(\btold\b)|(\banother\b)|(\bthan\b)|(\binto\b)/gi,o=e.replace(t,"");if(null==o||""==o)return null;var n=/\w+/g,s=o.match(n),a=s.reduce(function(e,t){return e[t]=e.hasOwnProperty(t)?e[t]+1:1,e},{});return a}function o(e){return e.weight>2}var n=t(e);if(null==n)return null;var s=Object.keys(n).map(function(e){var t={};return t.text=e,t.weight=n[e],t});return s.filter(o)}function s(){this.SurveyType="",this.OverallComp=0,this.ProcessRating=0,this.CommunicationComp=0,this.CourtesyComp=0,this.ResponsivenessComp=0,this.q6Satisfy=0,this.q7Satisfy=0,this.q8Satisfy=0,this.q9Satisfy=0,this.q10Satisfy=0,this.q11Satisfy=0,this.q12Satisfy=0,this.q13Satisfy=0,this.q15Satisfy=0,this.q16Satisfy=0,this.q17Satisfy=0,this.q18Satisfy=0,this.q6VerySatisfy=0,this.q7VerySatisfy=0,this.q8VerySatisfy=0,this.q9VerySatisfy=0,this.q10VerySatisfy=0,this.q11VerySatisfy=0,this.q12VerySatisfy=0,this.q13VerySatisfy=0,this.q15VerySatisfy=0,this.q16VerySatisfy=0,this.q17VerySatisfy=0,this.q18VerySatisfy=0,this.Comment="",this.RegionCode=0,this.Count=0}function a(){this.Livanta="",this.Kepro=""}function i(){this.SurveyType="",this.RegionAll=new a,this.Region1=new s,this.Region2=new s,this.Region3=new s,this.Region4=new s,this.Region5=new s,this.InterviewDate=""}function r(e,t){this.appeals=e,this.complaints=t,this.startDate="",this.endDate=""}function u(e){var t=new i;t.SurveyType="APPEALS",t.InterviewDate=e[e.length-1].InterviewDate;var o=new i;if(o.SurveyType="COMPLAINTS",o.InterviewDate=e[e.length-1].InterviewDate,e.length>=1){for(var n=0;n<e.length;n++)"APPEALS"===e[n].SurveyType?c(t,e[n]):"COMPLAINTS"===e[n].SurveyType&&c(o,e[n]);C(t),C(o)}return new r(t,o)}function l(e,t){e.OverallComp+=t.OverallComp,e.ProcessRating+=t.ProcessRating,e.CommunicationComp+=t.CommunicationComp,e.CourtesyComp+=t.CourtesyComp,e.ResponsivenessComp+=t.ResponsivenessComp,e.Comment+=t.Comment,1===t.q6Comp?e.q6VerySatisfy+=1:2===t.q6Comp&&(e.q6Satisfy+=1),1===t.q7Comp?e.q7VerySatisfy+=1:2===t.q7Comp&&(e.q7Satisfy+=1),1===t.q8Comp?e.q8VerySatisfy+=1:2===t.q8Comp&&(e.q8Satisfy+=1),1===t.q9Comp?e.q9VerySatisfy+=1:2===t.q9Comp&&(e.q9Satisfy+=1),1===t.q10Comp?e.q10VerySatisfy+=1:2===t.q10Comp&&(e.q10Satisfy+=1),1===t.q11Comp?e.q11VerySatisfy+=1:2===t.q11Comp&&(e.q11Satisfy+=1),1===t.q12Comp?e.q12VerySatisfy+=1:2===t.q12Comp&&(e.q12Satisfy+=1),1===t.q13Comp?e.q13VerySatisfy+=1:2===t.q13Comp&&(e.q13Satisfy+=1),1===t.q15Comp?e.q15VerySatisfy+=1:2===t.q15Comp&&(e.q15Satisfy+=1),1===t.q16Comp?e.q16VerySatisfy+=1:2===t.q16Comp&&(e.q16Satisfy+=1),1===t.q17Comp?e.q17VerySatisfy+=1:2===t.q17Comp&&(e.q17Satisfy+=1),1===t.q18Comp?e.q18VerySatisfy+=1:2===t.q18Comp&&(e.q18Satisfy+=1),e.Count+=1,e.RegionCode=t.RegionCode,e.SurveyType=t.SurveyType,e.InterviewDate=t.InterviewDate}function g(e,t){for(var o=["ProcessRating","q6VerySatisfy","q7VerySatisfy","q8VerySatisfy","q9VerySatisfy","q10VerySatisfy","q11VerySatisfy","q12VerySatisfy","q13VerySatisfy","q15VerySatisfy","q16VerySatisfy","q17VerySatisfy","q18VerySatisfy","q6Satisfy","q7Satisfy","q8Satisfy","q9Satisfy","q10Satisfy","q11Satisfy","q12Satisfy","q13Satisfy","q15Satisfy","q16Satisfy","q17Satisfy","q18Satisfy"],n=0;n<o.length;n++)e[o[n]]=Math.round10(e[o[n]]/t,-2);e.CommunicationComp=Math.round10((e.q7VerySatisfy+e.q7Satisfy+e.q8VerySatisfy+e.q8Satisfy+e.q9VerySatisfy+e.q9Satisfy)/3,-2),e.CourtesyComp=Math.round10((e.q6VerySatisfy+e.q6Satisfy+e.q10VerySatisfy+e.q10Satisfy)/2,-2),e.ResponsivenessComp=Math.round10((e.q11VerySatisfy+e.q11Satisfy+e.q12VerySatisfy+e.q12Satisfy)/2,-2),e.OverallComp=Math.round10((e.CommunicationComp+e.CourtesyComp+e.ResponsivenessComp)/3,-2)}function m(e,t,o,a,i,r,u){var l=new s,g=["q6VerySatisfy","q7VerySatisfy","q8VerySatisfy","q9VerySatisfy","q10VerySatisfy","q11VerySatisfy","q12VerySatisfy","q13VerySatisfy","q15VerySatisfy","q16VerySatisfy","q17VerySatisfy","q18VerySatisfy","q6Satisfy","q7Satisfy","q8Satisfy","q9Satisfy","q10Satisfy","q11Satisfy","q12Satisfy","q13Satisfy","q15Satisfy","q16Satisfy","q17Satisfy","q18Satisfy"];if("Li"===t){if(1==o&&1==u){l.Count=e.Region1.Count+e.Region5.Count,l.OverallComp=Math.round10((e.Region1.OverallComp*e.Region1.Count+e.Region5.OverallComp*e.Region5.Count)/l.Count,-2),l.ProcessRating=Math.round10((e.Region1.ProcessRating*e.Region1.Count+e.Region5.ProcessRating*e.Region5.Count)/l.Count,-2),l.CommunicationComp=Math.round10((e.Region1.CommunicationComp*e.Region1.Count+e.Region5.CommunicationComp*e.Region5.Count)/l.Count,-2),l.CourtesyComp=Math.round10((e.Region1.CourtesyComp*e.Region1.Count+e.Region5.CourtesyComp*e.Region5.Count)/l.Count,-2),l.ResponsivenessComp=Math.round10((e.Region1.ResponsivenessComp*e.Region1.Count+e.Region5.ResponsivenessComp*e.Region5.Count)/l.Count,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10((e.Region1[g[m]]*e.Region1.Count+e.Region5[g[m]]*e.Region5.Count)/l.Count,-2);l.Comment=n(e.Region1.Comment+" "+e.Region5.Comment)}else if(1==o&&0==u){l.Count=e.Region1.Count,l.OverallComp=Math.round10(e.Region1.OverallComp,-2),l.ProcessRating=Math.round10(e.Region1.ProcessRating,-2),l.CommunicationComp=Math.round10(e.Region1.CommunicationComp,-2),l.CourtesyComp=Math.round10(e.Region1.CourtesyComp,-2),l.ResponsivenessComp=Math.round10(e.Region1.ResponsivenessComp,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10(e.Region1[g[m]],-2);l.Comment=n(e.Region1.Comment)}else if(1==u&&0==o){l.Count=e.Region5.Count,l.OverallComp=Math.round10(e.Region5.OverallComp,-2),l.ProcessRating=Math.round10(e.Region5.ProcessRating,-2),l.CommunicationComp=Math.round10(e.Region5.CommunicationComp,-2),l.CourtesyComp=Math.round10(e.Region5.CourtesyComp,-2),l.ResponsivenessComp=Math.round10(e.Region5.ResponsivenessComp,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10(e.Region5[g[m]],-2);l.Comment=n(e.Region5.Comment)}}else if("Ke"===t)if(1==a&&1==i&&1==r){l.Count=e.Region2.Count+e.Region3.Count+e.Region4.Count,l.OverallComp=Math.round10((e.Region2.OverallComp*e.Region2.Count+e.Region3.OverallComp*e.Region3.Count+e.Region4.OverallComp*e.Region4.Count)/l.Count,-2),l.ProcessRating=Math.round10((e.Region2.ProcessRating*e.Region2.Count+e.Region3.ProcessRating*e.Region3.Count+e.Region4.ProcessRating*e.Region4.Count)/l.Count,-2),l.CommunicationComp=Math.round10((e.Region2.CommunicationComp*e.Region2.Count+e.Region3.CommunicationComp*e.Region3.Count+e.Region4.CommunicationComp*e.Region4.Count)/l.Count,-2),l.CourtesyComp=Math.round10((e.Region2.CourtesyComp*e.Region2.Count+e.Region3.CourtesyComp*e.Region3.Count+e.Region4.CourtesyComp*e.Region4.Count)/l.Count,-2),l.ResponsivenessComp=Math.round10((e.Region2.ResponsivenessComp*e.Region2.Count+e.Region3.ResponsivenessComp*e.Region3.Count+e.Region4.ResponsivenessComp*e.Region4.Count)/l.Count,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10((e.Region2[g[m]]*e.Region2.Count+e.Region3[g[m]]*e.Region3.Count+e.Region4[g[m]]*e.Region4.Count)/l.Count,-2);l.Comment=n(e.Region2.Comment+" "+e.Region3.Comment+" "+e.Region4.Comment)}else if(0==a&&1==i&&1==r){l.Count=e.Region3.Count+e.Region4.Count,l.OverallComp=Math.round10((e.Region3.OverallComp*e.Region3.Count+e.Region4.OverallComp*e.Region4.Count)/l.Count,-2),l.ProcessRating=Math.round10((e.Region3.ProcessRating*e.Region3.Count+e.Region4.ProcessRating*e.Region4.Count)/l.Count,-2),l.CommunicationComp=Math.round10((e.Region3.CommunicationComp*e.Region3.Count+e.Region4.CommunicationComp*e.Region4.Count)/l.Count,-2),l.CourtesyComp=Math.round10((e.Region3.CourtesyComp*e.Region3.Count+e.Region4.CourtesyComp*e.Region4.Count)/l.Count,-2),l.ResponsivenessComp=Math.round10((e.Region3.ResponsivenessComp*e.Region3.Count+e.Region4.ResponsivenessComp*e.Region4.Count)/l.Count,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10((e.Region3[g[m]]*e.Region3.Count+e.Region4[g[m]]*e.Region4.Count)/l.Count,-2);l.Comment=n(e.Region3.Comment+" "+e.Region4.Comment)}else if(0==a&&0==i&&1==r){l.Count=e.Region4.Count,l.OverallComp=Math.round10(e.Region4.OverallComp,-2),l.ProcessRating=Math.round10(e.Region4.ProcessRating,-2),l.CommunicationComp=Math.round10(e.Region4.CommunicationComp,-2),l.CourtesyComp=Math.round10(e.Region4.CourtesyComp,-2),l.ResponsivenessComp=Math.round10(e.Region4.ResponsivenessComp,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10(e.Region4[g[m]],-2);l.Comment=n(e.Region4.Comment)}else if(1==a&&0==i&&1==r){l.Count=e.Region2.Count+e.Region4.Count,l.OverallComp=Math.round10((e.Region2.OverallComp*e.Region2.Count+e.Region4.OverallComp*e.Region4.Count)/l.Count,-2),l.ProcessRating=Math.round10((e.Region2.ProcessRating*e.Region2.Count+e.Region4.ProcessRating*e.Region4.Count)/l.Count,-2),l.CommunicationComp=Math.round10((e.Region2.CommunicationComp*e.Region2.Count+e.Region4.CommunicationComp*e.Region4.Count)/l.Count,-2),l.CourtesyComp=Math.round10((e.Region2.CourtesyComp*e.Region2.Count+e.Region4.CourtesyComp*e.Region4.Count)/l.Count,-2),l.ResponsivenessComp=Math.round10((e.Region2.ResponsivenessComp*e.Region2.Count+e.Region4.ResponsivenessComp*e.Region4.Count)/l.Count,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10((e.Region2[g[m]]*e.Region2.Count+e.Region4[g[m]]*e.Region4.Count)/l.Count,-2);l.Comment=n(e.Region2.Comment+" "+e.Region4.Comment)}else if(1==a&&1==i&&0==r){l.Count=e.Region2.Count+e.Region3.Count,l.OverallComp=Math.round10((e.Region2.OverallComp*e.Region2.Count+e.Region3.OverallComp*e.Region3.Count)/l.Count,-2),l.ProcessRating=Math.round10((e.Region2.ProcessRating*e.Region2.Count+e.Region3.ProcessRating*e.Region3.Count)/l.Count,-2),l.CommunicationComp=Math.round10((e.Region2.CommunicationComp*e.Region2.Count+e.Region3.CommunicationComp*e.Region3.Count)/l.Count,-2),l.CourtesyComp=Math.round10((e.Region2.CourtesyComp*e.Region2.Count+e.Region3.CourtesyComp*e.Region3.Count)/l.Count,-2),l.ResponsivenessComp=Math.round10((e.Region2.ResponsivenessComp*e.Region2.Count+e.Region3.ResponsivenessComp*e.Region3.Count)/l.Count,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10((e.Region2[g[m]]*e.Region2.Count+e.Region3[g[m]]*e.Region3.Count)/l.Count,-2);l.Comment=n(e.Region2.Comment+" "+e.Region3.Comment)}else if(1==a&&0==i&&0==r){l.Count=e.Region2.Count,l.OverallComp=Math.round10(e.Region2.OverallComp,-2),l.ProcessRating=Math.round10(e.Region2.ProcessRating,-2),l.CommunicationComp=Math.round10(e.Region2.CommunicationComp,-2),l.CourtesyComp=Math.round10(e.Region2.CourtesyComp,-2),l.ResponsivenessComp=Math.round10(e.Region2.ResponsivenessComp,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10(e.Region2[g[m]],-2);l.Comment=n(e.Region2.Comment)}else if(0==a&&1==i&0==r){l.Count=e.Region3.Count,l.OverallComp=Math.round10(e.Region3.OverallComp,-2),l.ProcessRating=Math.round10(e.Region3.ProcessRating,-2),l.CommunicationComp=Math.round10(e.Region3.CommunicationComp,-2),l.CourtesyComp=Math.round10(e.Region3.CourtesyComp,-2),l.ResponsivenessComp=Math.round10(e.Region3.ResponsivenessComp,-2);for(var m=0;m<g.length;m++)l[g[m]]=Math.round10(e.Region3[g[m]],-2);l.Comment=n(e.Region3.Comment)}return l}function C(e){for(var t=1;6>t;t++)e["Region"+t].Count>0&&g(e["Region"+t],e["Region"+t].Count);0!=e.Region1.Count&&0!=e.Region5.Count?e.RegionAll.Livanta=m(e,"Li",!0,!1,!1,!1,!0):0!=e.Region1.Count?e.RegionAll.Livanta=m(e,"Li",!0,!1,!1,!1,!1):0!=e.Region5.Count&&(e.RegionAll.Livanta=m(e,"Li",!1,!1,!1,!1,!0)),0!=e.Region2.Count&&0!=e.Region3.Count&&0!=e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!0,!0,!0,!1):0==e.Region2.Count&&0!=e.Region3.Count&&0!=e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!1,!0,!0,!1):0!=e.Region2.Count&&0!=e.Region3.Count&&0==e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!0,!0,!1,!1):0!=e.Region2.Count&&0==e.Region3.Count&&0!=e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!0,!1,!0,!1):0==e.Region2.Count&&0==e.Region3.Count&&0!=e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!1,!1,!0,!1):0!=e.Region2.Count&&0==e.Region3.Count&&0==e.Region4.Count?e.RegionAll.Kepro=m(e,"Ke",!1,!0,!1,!1,!1):0==e.Region2.Count&&0!=e.Region3.Count&&0==e.Region4.Count&&(e.RegionAll.Kepro=m(e,"Ke",!1,!1,!0,!1,!1));for(var t=1;6>t;t++)e["Region"+t].Comment=n(e["Region"+t].Comment)}function c(e,t){switch(t.RegionCode){case 1:l(e.Region1,t);break;case 2:l(e.Region2,t);break;case 3:l(e.Region3,t);break;case 4:l(e.Region4,t);break;case 5:l(e.Region5,t)}}var p=new Date,R=new Date(p.getFullYear(),p.getMonth(),p.getDate()-14),d=new Date(p.getFullYear(),p.getMonth(),p.getDate()-30),h=new Date(p.getFullYear(),p.getMonth(),p.getDate()-90),y=new Date(2015,8,1);t.choosenResult={},t.loading=!0,t.showTrend=!1,t.showRegionAll=!0,t.showRegion1=!1,t.showRegion2=!1,t.showRegion3=!1,t.showRegion4=!1,t.showRegion5=!1,t.showDetailCourtesy={},t.showDetailResponsiveness={},t.showDetailCommunication={};for(var f=["all","r1","r2","r3","r4","r5"],v=0;v<f.length;v++)t.showDetailCourtesy[f[v]]=!1,t.showDetailResponsiveness[f[v]]=!1,t.showDetailCommunication[f[v]]=!1;t.surveyType=["APPEALS","COMPLAINTS"],t.setResult=function(n){switch(t.showTrend&&(t.showTrend=!1),n){case"lastTwoWeek":null!=t.lastTwoWeekResults?t.choosenResult=t.lastTwoWeekResults:(t.loading=!0,o.getResultByDate(e(R),e(p)).success(function(e){t.lastTwoWeekResults=u(e),t.lastTwoWeekResults.startDate=R,t.lastTwoWeekResults.endDate=p,t.choosenResult=t.lastTwoWeekResults,t.loading=!1}).error(function(e){console.log(e)}));break;case"lastMonth":null!=t.lastMonthResults?t.choosenResult=t.lastMonthResults:(t.loading=!0,o.getResultByDate(e(d),e(p)).success(function(e){t.lastMonthResults=u(e),t.lastMonthResults.startDate=d,t.lastMonthResults.endDate=p,t.choosenResult=t.lastMonthResults,t.loading=!1}).error(function(e){console.log(e)}));break;case"lastQuarter":null!=t.lastQuarterResults?t.choosenResult=t.lastQuarterResults:(t.loading=!0,o.getResultByDate(e(h),e(p)).success(function(e){t.lastQuarterResults=u(e),t.lastQuarterResults.startDate=h,t.lastQuarterResults.endDate=p,t.choosenResult=t.lastQuarterResults,t.loading=!1}).error(function(e){console.log(e)}));break;case"allTime":null!=t.cumulativeResults?t.choosenResult=t.cumulativeResults:(t.loading=!0,o.getResult().success(function(e){t.cumulativeResults=u(e),t.cumulativeResults.startDate=y,t.cumulativeResults.endDate=p,t.choosenResult=t.cumulativeResults,t.loading=!1}).error(function(e){console.log(e)}))}},t.showTrendSection=function(e){(null==t.trendData||void 0==t.trendData)&&(t.loading=!0,o.getTrendData().success(function(e){t.trendData=e,t.loading=!1}).error(function(e){console.log(e)})),t.showTrend=!0},t.setRegion=function(e){switch(t.showTrend&&(t.showTrend=!1),e){case"rall":t.showRegion1=!1,t.showRegion2=!1,t.showRegion3=!1,t.showRegion4=!1,t.showRegion5=!1,t.showRegionAll=!0;break;case"r1":t.showRegionAll=!1,t.showRegion2=!1,t.showRegion3=!1,t.showRegion4=!1,t.showRegion5=!1,t.showRegion1=!0;break;case"r2":t.showRegion1=!1,t.showRegionAll=!1,t.showRegion3=!1,t.showRegion4=!1,t.showRegion5=!1,t.showRegion2=!0;break;case"r3":t.showRegion1=!1,t.showRegion2=!1,t.showRegionAll=!1,t.showRegion4=!1,t.showRegion5=!1,t.showRegion3=!0;break;case"r4":t.showRegion1=!1,t.showRegion2=!1,t.showRegion3=!1,t.showRegionAll=!1,t.showRegion5=!1,t.showRegion4=!0;break;case"r5":t.showRegion1=!1,t.showRegion2=!1,t.showRegion3=!1,t.showRegion4=!1,t.showRegionAll=!1,t.showRegion5=!0}},t.showDetail=function(e,o){switch(e){case"Communication":switch(o){case"all":t.showDetailCourtesy.all=!1,t.showDetailResponsiveness.all=!1,t.showDetailCommunication.all=!t.showDetailCommunication.all;break;case"r1":t.showDetailCourtesy.r1=!1,t.showDetailResponsiveness.r1=!1,t.showDetailCommunication.r1=!t.showDetailCommunication.r1;break;case"r2":t.showDetailCourtesy.r2=!1,t.showDetailResponsiveness.r2=!1,t.showDetailCommunication.r2=!t.showDetailCommunication.r2;break;case"r3":t.showDetailCourtesy.r3=!1,t.showDetailResponsiveness.r3=!1,t.showDetailCommunication.r3=!t.showDetailCommunication.r3;break;case"r4":t.showDetailCourtesy.r4=!1,t.showDetailResponsiveness.r4=!1,t.showDetailCommunication.r4=!t.showDetailCommunication.r4;break;case"r5":t.showDetailCourtesy.r5=!1,t.showDetailResponsiveness.r5=!1,t.showDetailCommunication.r5=!t.showDetailCommunication.r5}break;case"Courtesy":switch(o){case"all":t.showDetailCommunication.all=!1,t.showDetailResponsiveness.all=!1,t.showDetailCourtesy.all=!t.showDetailCourtesy.all;break;case"r1":t.showDetailCommunication.r1=!1,t.showDetailResponsiveness.r1=!1,t.showDetailCourtesy.r1=!t.showDetailCourtesy.r1;break;case"r2":t.showDetailCommunication.r2=!1,t.showDetailResponsiveness.r2=!1,t.showDetailCourtesy.r2=!t.showDetailCourtesy.r2;break;case"r3":t.showDetailCommunication.r3=!1,t.showDetailResponsiveness.r3=!1,t.showDetailCourtesy.r3=!t.showDetailCourtesy.r3;break;case"r4":t.showDetailCommunication.r4=!1,t.showDetailResponsiveness.r4=!1,t.showDetailCourtesy.r4=!t.showDetailCourtesy.r4;break;case"r5":t.showDetailCommunication.r5=!1,t.showDetailResponsiveness.r5=!1,t.showDetailCourtesy.r5=!t.showDetailCourtesy.r5}break;case"Responsiveness":switch(o){case"all":t.showDetailCommunication.all=!1,t.showDetailCourtesy.all=!1,t.showDetailResponsiveness.all=!t.showDetailResponsiveness.all;break;case"r1":t.showDetailCommunication.r1=!1,t.showDetailCourtesy.r1=!1,t.showDetailResponsiveness.r1=!t.showDetailResponsiveness.r1;break;case"r2":t.showDetailCommunication.r2=!1,t.showDetailCourtesy.r2=!1,t.showDetailResponsiveness.r2=!t.showDetailResponsiveness.r2;break;case"r3":t.showDetailCommunication.r3=!1,t.showDetailCourtesy.r3=!1,t.showDetailResponsiveness.r3=!t.showDetailResponsiveness.r3;break;case"r4":t.showDetailCommunication.r4=!1,t.showDetailCourtesy.r4=!1,t.showDetailResponsiveness.r4=!t.showDetailResponsiveness.r4;break;case"r5":t.showDetailCommunication.r5=!1,t.showDetailCourtesy.r5=!1,t.showDetailResponsiveness.r5=!t.showDetailResponsiveness.r5}}},t.keproColors=["#1B5E20","#388E3C","#76FF03","#00C853","#4CAF50","#00E676","#69F0AE"],t.livantaColors=["#1A237E","#01579B","#0288D1","#0091EA","#00B0FF","#40C4FF","#B3E5FC"],t.setResult("lastMonth")}var o="surveyController";angular.module("SurveyApp").controller(o,["$scope","surveyFactory",t])}(),function(){function e(e,t,o){return"undefined"==typeof o||0===+o?Math[e](t):(t=+t,o=+o,isNaN(t)||"number"!=typeof o||o%1!==0?0/0:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-o:-o))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+o:o))))}Math.round10||(Math.round10=function(t,o){return e("round",t,o)}),Math.floor10||(Math.floor10=function(t,o){return e("floor",t,o)}),Math.ceil10||(Math.ceil10=function(t,o){return e("ceil",t,o)})}(),function(){"use strict";angular.module("SurveyApp").directive("d3Circle",function(e,t){var o=function(e,t,o){var n=o.surveytype,s=parseInt(d3.select(t[0]).style("width"));239>s&&(s=239);var a=o.height,i=d3.select(t[0]).append("svg").attr({width:s,height:a});e.$watch("result",function(t,o){function r(e,t){e.attrTween("d",function(e){var o=d3.interpolate(e.endAngle,t);return function(t){return e.endAngle=o(t),m(e)}})}if(i.selectAll("*").remove(),t){var u=e.result,l="translate("+(s/2-15)+","+a/2+")",g="translate("+.33*s+","+.57*a+")";switch(n){case"Li":{var m=d3.svg.arc().innerRadius(45).outerRadius(60).startAngle(0);i.append("path").attr("transform",l).datum({endAngle:2*Math.PI}).style("fill","#ddd").attr("d",m),i.append("path").attr("transform",l).datum({endAngle:0}).style("fill","#337AB7").attr("d",m).transition().duration(750).call(r,2*u*Math.PI)}i.append("text").attr("d",0).attr("transform",g).text(""+parseInt(100*u)+"%").style("font-size","28px");break;case"Ke":{var m=d3.svg.arc().innerRadius(45).outerRadius(60).startAngle(0);i.append("path").attr("transform",l).datum({endAngle:2*Math.PI}).style("fill","#ddd").attr("d",m),i.append("path").attr("transform",l).datum({endAngle:0}).style("fill","#5CB85C").attr("d",m).transition().duration(750).call(r,2*u*Math.PI)}i.append("text").attr("d",0).attr("transform",g).text(""+parseInt(100*u)+"%").style("font-size","28px")}}})};return{restrict:"E",scope:{result:"@"},link:o}}),angular.module("SurveyApp").directive("d3Line",function(e,t){var o=function(e,t,o){var n=d3.select(t[0]);e.$watch("data",function(t){if(n.selectAll("*").remove(),t){if("appeals"==e.section)var o=t.trendData.APPEALS,s=t.countList.slice(0,5);else if("complaints"==e.section)var o=t.trendData.COMPLAINTS,s=t.countList.slice(5,10);var a=d3.time.format("%Y-%m-%dT%H:%M:%S"),i={top:20,right:20,bottom:100,left:50},r=508-i.left-i.right,u=450-i.top-i.bottom,l=d3.time.scale().range([0,r]),g=d3.scale.linear().range([u,0]),m=d3.svg.axis().scale(g).orient("left"),C=d3.svg.line().interpolate("monotone").x(function(e){return l(a.parse(e.date))}).y(function(e){return g(e.score)}),c=n.append("svg").attr("width",r+i.left+i.right).attr("height",u+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")").attr("class","d3-line");if("all"==e.stype){var p=d3.nest().key(function(e){return e.date}).rollup(function(e){var t=d3.sum(e,function(e){return e.score})/d3.sum(e,function(e){return e.count});return{date:e[0].date,score:t}}),R=d3.values(p.map(o[1].concat(o[5]))),d=d3.values(p.map(o[2].concat(o[3],o[4]))),h=d3.min(R,function(e){return a.parse(e.date)}),y=d3.max(R,function(e){return a.parse(e.date)}),f=d3.min(R,function(e){return e.score});h>d3.min(d,function(e){return a.parse(e.date)})&&(h=d3.min(d,function(e){return a.parse(e.date)})),y<d3.max(d,function(e){return a.parse(e.date)})&&(y=d3.max(d,function(e){return a.parse(e.date)})),f>d3.min(d,function(e){return e.score})&&(f=d3.min(d,function(e){return e.score})),f-=10,l.domain([h,y]),g.domain([30,100]);var v=d3.time.scale().domain([h,y]).range([0,r]),w=d3.svg.axis().scale(v).orient("bottom").ticks(d3.time.day,6).tickFormat(d3.time.format("%b %d"));if(c.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").call(w).selectAll("text").attr("y",15).attr("x",-10).attr("dy",".35em").style("text-anchor","start"),c.append("g").attr("class","y axis").call(m).append("text").attr("y",6).attr("dy",".71em").attr("transform","translate(-50,150), rotate(-90)").text("Percentage (%)"),s[0]+s[4]>=30){var b="Livanta (N = "+(s[0]+s[4])+")";c.append("path").attr("d",C(R)).attr("class","line").attr("data-legend",b).attr("data-legend-pos",0)}if(s[1]+s[2]+s[3]>=30){var S="Kepro (N = "+(s[1]+s[2]+s[3])+")";c.append("path").attr("d",C(d)).style("stroke","#5CB85C").attr("class","line").attr("data-legend",S).attr("data-legend-pos",0)}var q=(c.append("g").attr("class","legend").attr("transform","translate(160,390)").style("font-size","12px").call(d3.legend),d3.select("body").append("div").attr("class","tooltip").style("opacity",0),d3.time.format("%Y-%m-%dT%H:%M:%S").parse),D=d3.time.format("%m/%d/%Y"),M=d3.tip().attr("class","d3-tip").offset([-15,0]).html(function(e){return"<strong>Score: "+parseInt(e.score)+"%<br/>Date: "+D(q(e.date))+"</strong>"});c.call(M),c.selectAll("dot").data(R).enter().append("circle").attr("r",3).attr("fill","white").attr("stroke","steelblue").attr("stroke-width",1).attr("cx",function(e){return l(a.parse(e.date))}).attr("cy",function(e){return g(e.score)}).on("mouseover",M.show).on("mouseout",M.hide),s[1]+s[2]+s[3]>=30&&c.selectAll("dot").data(d).enter().append("circle").attr("r",3).attr("fill","white").attr("stroke","steelblue").attr("stroke-width",1).attr("cx",function(e){return l(a.parse(e.date))}).attr("cy",function(e){return g(e.score)}).on("mouseover",M.show).on("mouseout",M.hide)}else if("region"==e.stype){for(var A=1;6>A;A++)o[A]=o[A].map(function(e){return{date:e.date,score:e.score/e.count}});for(var h=d3.min(o[1],function(e){return a.parse(e.date)}),y=d3.max(o[1],function(e){return a.parse(e.date)}),f=d3.min(o[1],function(e){return e.score}),A=2;6>A;A++){var k=d3.min(o[A],function(e){return a.parse(e.date)});h>k&&(h=k);var V=d3.max(o[A],function(e){return a.parse(e.date)});V>y&&(y=V);var P=d3.min(o[A],function(e){return e.score});f>P&&(f=P)}f-=10,l.domain([h,y]),g.domain([30,100]);var v=d3.time.scale().domain([h,y]).range([0,r]),w=d3.svg.axis().scale(v).orient("bottom").ticks(d3.time.day,6).tickFormat(d3.time.format("%b %d"));c.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").call(w).selectAll("text").attr("y",15).attr("x",-10).attr("dy",".35em").style("text-anchor","start"),c.append("g").attr("class","y axis").call(m).append("text").attr("y",6).attr("dy",".71em").attr("transform","translate(-50,150), rotate(-90)").text("Percentage (%)");var x="Area 1 (N = "+s[0]+")",O="Area 2 (N = "+s[1]+")",T="Area 3 (N = "+s[2]+")",L="Area 4 (N = "+s[3]+")",I="Area 5 (N = "+s[4]+")";s[0]>=30&&c.append("path").attr("d",C(o[1])).attr("class","line").attr("data-legend",x).attr("data-legend-pos",0),s[1]>=30&&c.append("path").attr("d",C(o[2])).style("stroke","#5CB85C").attr("class","line").attr("data-legend",O).attr("data-legend-pos",0),s[2]>=30&&c.append("path").attr("d",C(o[3])).style("stroke","#ff7f0e").attr("class","line").attr("data-legend",T).attr("data-legend-pos",0),s[3]>=30&&c.append("path").attr("d",C(o[4])).style("stroke","#d62728").attr("class","line").attr("data-legend",L).attr("data-legend-pos",0),s[4]>=30&&c.append("path").attr("d",C(o[5])).style("stroke","#8c564b").attr("class","line").attr("data-legend",I).attr("data-legend-pos",0);var q=(c.append("g").attr("class","legend").attr("transform","translate(160,370)").style("font-size","12px").call(d3.legend),d3.select("body").append("div").attr("class","tooltip").style("opacity",0),d3.time.format("%Y-%m-%dT%H:%M:%S").parse),D=d3.time.format("%m/%d/%Y"),M=d3.tip().attr("class","d3-tip").offset([-15,0]).html(function(e){return"<strong>Score: "+parseInt(e.score)+"%<br/>Date: "+D(q(e.date))+"</strong>"});c.call(M);for(var E=1;6>E;E++)s[E-1]>=30&&c.selectAll("dot").data(o[E]).enter().append("circle").attr("r",3).attr("fill","white").attr("stroke","steelblue").attr("stroke-width",1).attr("cx",function(e){return l(a.parse(e.date))}).attr("cy",function(e){return g(e.score)}).on("mouseover",M.show).on("mouseout",M.hide)}}})};return{restrict:"E",scope:{data:"=data",stype:"=",section:"="},link:o}}),angular.module("SurveyApp").directive("surveyDetailScoreLi",function(){return{restrict:"E",scope:{verysatisfy:"@",satisfy:"@"},templateUrl:"/ng-template/survey-detail-score-li.html"}}),angular.module("SurveyApp").directive("surveyDetailScoreKe",function(){return{restrict:"E",scope:{verysatisfy:"@",satisfy:"@"},templateUrl:"/ng-template/survey-detail-score-ke.html"}}),angular.module("SurveyApp").directive("regionLi",function(){return{restrict:"E",scope:{result:"=",startdate:"=",enddate:"=",regionname:"=regionname",regionid:"@"},templateUrl:"/ng-template/region-li.html"}}),angular.module("SurveyApp").directive("regionKe",function(){return{restrict:"E",scope:{result:"=",startdate:"=",enddate:"=",regionname:"=regionname",regionid:"@"},templateUrl:"/ng-template/region-ke.html"}}),angular.module("SurveyApp").directive("regionAll",function(){return{restrict:"E",scope:{result:"=",startdate:"=",enddate:"=",regionname:"=regionname",regionid:"@"},templateUrl:"/ng-template/region-all.html"}})}(),function(){d3.legend=function(e){return e.each(function(){var e=d3.select(this),t={},o=d3.select(e.property("nearestViewportElement")),n=(e.attr("data-style-padding")||5,e.selectAll(".legend-box").data([!0])),s=e.selectAll(".legend-items").data([!0]);n.enter().append("rect").classed("legend-box",!0),s.enter().append("g").classed("legend-items",!0),o.selectAll("[data-legend]").each(function(){var e=d3.select(this);t[e.attr("data-legend")]={pos:e.attr("data-legend-pos")||this.getBBox().y,color:void 0!=e.attr("data-legend-color")?e.attr("data-legend-color"):e.style("none"!=e.style("fill")?"fill":"stroke")}}),t=d3.entries(t).sort(function(e,t){return e.value.pos-t.value.pos}),s.selectAll("text").data(t,function(e){return e.key}).call(function(e){e.enter().append("text")}).call(function(e){e.exit().remove()}).attr("y",function(e,t){return t+"em"}).attr("x","1em").text(function(e){return e.key}),s.selectAll("circle").data(t,function(e){return e.key}).call(function(e){e.enter().append("circle")}).call(function(e){e.exit().remove()}).attr("cy",function(e,t){return t-.25+"em"}).attr("cx",0).attr("r","0.4em").style("fill",function(e){return e.value.color})}),e}}(),function(){"use strict";function e(e){var t=function(){return e.get("/api/DataVisualApp").success(function(e){return e}).error(function(e){console.log(e)})},o=function(t,o){return e.get("/api/DataVisualApp/"+t+"/"+o).success(function(e){return e}).error(function(e){console.log(e)})},n=function(){return e.get("/api/DataVisualApp/GetTrendData").success(function(e){return e}).error(function(e){console.log(e)})},s={getResult:t,getResultByDate:o,getTrendData:n};return s}var t="surveyFactory";angular.module("SurveyApp").factory(t,["$http",e])}();